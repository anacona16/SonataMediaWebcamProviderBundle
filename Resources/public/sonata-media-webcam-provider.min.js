!function(){var t=720,e=0,a=!1,n=null,i=null,o=null,c=null,d=null;function r(){n=document.getElementById("anacona16-sonata-media-webcam-camera"),i=document.getElementById("anacona16-sonata-media-webcam-camera-canvas"),o=document.getElementById("anacona16-sonata-media-webcam-snapshots-photo"),c=document.getElementById("anacona16-sonata-media-webcam-take-snapshots"),d=document.querySelector(".anacona16-sonata-media-webcam-provider-binary-content"),null!==n&&(navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then(function(t){n.srcObject=t,n.play()}).catch(function(t){console.log("An error occurred: "+t)}),n.addEventListener("canplay",function(o){a||(e=n.videoHeight/(n.videoWidth/t),isNaN(e)&&(e=t/(4/3)),n.setAttribute("width",t),n.setAttribute("height",e),i.setAttribute("width",t),i.setAttribute("height",e),a=!0)},!1),c.addEventListener("click",function(a){!function(){var a=i.getContext("2d");if(t&&e){i.width=t,i.height=e,a.drawImage(n,0,0,t,e);var c=i.toDataURL("image/png");o.setAttribute("src",c),d.setAttribute("value",c.split(",")[1])}else u()}(),a.preventDefault()},!1),u())}function u(){var t=i.getContext("2d");t.fillStyle="#AAA",t.fillRect(0,0,i.width,i.height);var e=i.toDataURL("image/png");o.setAttribute("src",e)}window.addEventListener("load",r,!1),$(function(){$(window).ajaxSuccess(function(t,e,a){a.url.includes("provider=sonata.media.provider.webcam")&&r()})})}(jQuery);
